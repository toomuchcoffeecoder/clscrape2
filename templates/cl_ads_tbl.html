{% extends "base.html" %}
{% block head %}
    {{ super() }}
    <!-- Include one of jTable styles. -->
    <link href="{{url_for('static', filename='jquery-ui-1.12.1/jquery-ui.min.css')}}" rel="stylesheet" type="text/css" />
    <link href="{{url_for('static', filename='jtable.2.4.0/themes/metro/blue/jtable.min.css')}}" rel="stylesheet" type="text/css" />
    <style type="text/css">
    <!-- Include jTable script file. -->
        .important { color: #336699; }
        div.jtable-main-container>table.jtable>tbody>tr.jtable-row-even.new_rec {background-color: #90f9a7 }
        div.jtable-main-container>table.jtable>tbody>tr.new_rec {background-color: #53e873}
    </style>
    <script src="{{url_for('static', filename='js/jquery-3.1.1.min.js')}}" type="text/javascript"></script>
    <script src="{{url_for('static', filename='jquery-ui-1.12.1/jquery-ui.min.js')}}" type="text/javascript"></script>
    <script src="{{url_for('static', filename='jtable.2.4.0/jquery.jtable.min.js')}}" type="text/javascript"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $('#CLAdTableContainer').jtable({
                title: 'Craigs List Ad Table',
                paging: true,
                sorting: true,
                actions: {
                    listAction: '/cl_ads_list'
                },
                rowInserted: function(event, data) {
                    if (data.record['new_rec']) {
                    // if new record then ad new_rec class to row so it background is green
                        $(this).find("tr").addClass("new_rec")
                    }
                },
                fields: {
                    ad_id: {
                        key: true,
                        list: false
                    },
                    state: {
                        title: 'State',
                        width: '12%'
                    },
                    city: {
                        title: 'City',
                        width: '12%'
                    },
                    title: {
                        title: 'Title',
                        width: '16%'
                    },
                    description: {
                        title: 'Description',
                        width: '24%'
                    },
                    link: {
                        title: 'link',
                        width: '12%',
                        sorting: false
                    },
                    link_key: {
                        title: 'link_key',
                        width: '12%',
                        list: false
                    },
                    date_str: {
                        title: 'date_str',
                        width: '12%'
                    },
                    dt: {
                        title: 'dt',
                        width: '12%'
                    },
                    new_rec: {
                        list: false
                    }
                }
            })
            $('#CLAdTableContainer').jtable('load')

            $( "#search_form" ).submit(function( event ) {
                    var search = $("#search_term").val()
                    $('#CLAdTableContainer').jtable('load', {search: search})
                    event.preventDefault();
            })
        })
        
    </script>

{% endblock %}
{% block content %}
    <form id="search_form">
        <label for="search">Search</label>
        <input type="text" id="search_term" name="search">
        <input type="submit" value="Search">
    </form>
    <br>
    <div id="CLAdTableContainer"></div>
{% endblock %}
